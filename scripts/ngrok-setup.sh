#!/bin/bash

# üåê –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–æ–≥–æ —Ç—É–Ω–Ω–µ–ª—é —á–µ—Ä–µ–∑ ngrok

echo "üåê –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É —á–µ—Ä–µ–∑ ngrok..."

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π ngrok
if ! command -v ngrok &> /dev/null; then
    echo "‚ùå ngrok –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π"
    echo "üì• –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è ngrok..."
    
    # –î–ª—è macOS
    if [[ "$OSTYPE" == "darwin"* ]]; then
        brew install ngrok
    else
        echo "‚ùå –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å ngrok –≤—Ä—É—á–Ω—É –∑ https://ngrok.com/download"
        exit 1
    fi
fi

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –∑–∞–ø—É—â–µ–Ω–∏–π –ª–æ–∫–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä
if ! curl -s http://localhost:8000 > /dev/null; then
    echo "üöÄ –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞..."
    python3 -m http.server 8000 &
    SERVER_PID=$!
    sleep 2
fi

# –ó–∞–ø—É—Å–∫ ngrok
echo "üåê –ó–∞–ø—É—Å–∫ ngrok —Ç—É–Ω–Ω–µ–ª—é..."
echo "üì± –í–∞—à —Å–∞–π—Ç –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –ø—É–±–ª—ñ—á–Ω–∏–º URL"
echo "‚è≥ –ó–∞—á–µ–∫–∞–π—Ç–µ 5 —Å–µ–∫—É–Ω–¥..."

ngrok http 8000 --log=stdout
